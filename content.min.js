'use strict';function _toConsumableArray(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}return Array.from(arr)}var storage=JSON.parse(localStorage.getItem('eot'))||{};addListeners(),run();function addListeners(){var a=document.getElementById('js-repo-pjax-container'),b=new MutationObserver(function(c){c.length&&run()});b.observe(a,{childList:!0}),a.addEventListener('click',function(c){c.target.classList.contains('js--eot-button')?onButtonClicked(c.target):c.target.parentNode.classList.contains('js--eot-button')&&onButtonClicked(c.target.parentNode)})}function run(){var a=document.querySelectorAll('.file.js-comment-container:not(.outdated-comment)'),b=document.querySelectorAll('.comment-holder.js-line-comments');[].concat(_toConsumableArray(a),_toConsumableArray(b)).map(appendHeader).map(setVisibility).map(setCommentsNumber)}function appendHeader(a){var b='\n        <div class="text-right p-2 js--eot-toggle-header">\n            <div class="btn btn-sm js--eot-button">\n                <span class="js--eot-text"></span>\n                <span class="counter js--eot-counter"></span>\n            </div>\n        </div>\n     ';return a.insertAdjacentHTML('afterbegin',b),a}function setVisibility(a){var b=a.querySelector('.js-comment').id.replace('discussion_',''),c=a.querySelector('.js--eot-toggle-header'),d=a.querySelector('.js--eot-button'),e=storage[b]&&storage[b].isActive,f=storage[b]&&storage[b].commentsCount,g=f===getCommentsNumber(a)||!f;return c.dataset.commentId=b,e?(c.classList.add('eot__hide'),d.classList.add('selected')):(c.classList.remove('eot__hide'),d.classList.remove('selected')),g?(d.classList.add('btn-outline'),a.querySelector('.js--eot-text').innerText='#eot'):(d.classList.add('btn-danger'),a.querySelector('.js--eot-text').innerText='#nope'),a}function setCommentsNumber(a){return a.querySelector('.js--eot-counter').innerText=''+getCommentsNumber(a),a}function getCommentsNumber(a){return a.querySelectorAll('.js-comment').length}function onButtonClicked(a){var b=a.parentNode,c=void 0;a.classList.toggle('selected'),c=a.classList.contains('selected'),b.classList[c?'add':'remove']('eot__hide'),storage[b.dataset.commentId]={isActive:c,commentsCount:+b.querySelector('.js--eot-counter').innerText},localStorage.setItem('eot',JSON.stringify(storage))}